<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <title>Jellyfin Spotlight v2.6.4</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
		@import url('https://fonts.googleapis.com/css2?family=Sofia+Sans:ital,wght@0,1..1000;1,1..1000&display=swap');
		body { margin: 0; padding: 0; overflow: hidden; }
		.slide { -webkit-touch-callout: none; -webkit-tap-highlight-color: transparent; user-select: none; -webkit-user-select: none; -ms-user-select: none; touch-action: manipulation;}
		.slide:focus { outline: 2px solid #fff; }
		.backdrop { position: absolute; top: 0em; height: 100%; object-fit: cover; object-position: center 30%; z-index: 1; transform-origin: top;}
		.heading::before { content: ''; position: absolute; top: 2.27em; left: 0; width: 100%; height: 100vh; background: linear-gradient(0deg, rgb(0% 0% 0%) 0%, rgb(0% 0% 0% / 0.9990234375) 6.25%, rgba(0, 0, 0, 0.99) 12.5%, rgba(0, 0, 0, 0.97) 18.75%, rgba(0, 0, 0, 0.94) 25%, rgba(0, 0, 0, 0.88) 31.25%, rgba(0, 0, 0, 0.79) 37.5%, rgba(0, 0, 0, 0.67) 43.75%, rgba(0, 0, 0, 0.5) 50%, rgba(0, 0, 0, 0.33) 56.25%, rgba(0, 0, 0, 0.21) 62.5%, rgba(0, 0, 0, 0.12) 68.75%, rgba(0, 0, 0, 0.06) 75%, rgba(0, 0, 0, 0.03) 81.25%, rgba(0, 0, 0, 0.01) 87.5%, rgba(0, 0, 0, 0) 93.75%, rgba(0, 0, 0, 0) 100% ); z-index: 7; opacity: 0;}
		.heading { position: absolute; top: 0; left: 0; width: 100%; height: 2.3em; background-color: transparent; font-family: "Sofia Sans", sans-serif; color: #D3D3D3; font-size: 22px; display: none; align-items: center; justify-content: flex-start; z-index: 2; padding: 10px; padding-left: 0px; box-sizing: border-box; text-shadow: 1px 1px 4px rgba(0, 0, 0, 1); }
		.back-button, .skip-button { position: absolute; color: #fff; cursor: pointer; z-index: 10; font-family: "Sofia Sans", sans-serif; text-shadow: 1px 1px 4px rgba(0, 0, 0, 1); font-size: 2em;}
		 .details-button {display: none;}
		.material-icons {font-size: 1em;}
		.video-container { position: absolute; border-top-right-radius: 0.5em; border-bottom-right-radius: 0.5em; }
		.video-player { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 7; }
		.clickable-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; cursor: pointer; background: transparent; transition: background 0.8s ease, backdrop-filter 0.8s ease;}
		.lorem-ipsum {position: absolute; bottom: 20.1em; font-family: "Sofia Sans", sans-serif; font-size: 1em; font-weight: 350; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1); opacity: 1; color: #fff; z-index: 9; box-sizing: border-box; background: transparent; max-width: fit-content; padding-left: 90vw; padding-right: 0.3em; display: flex; flex-direction: row; max-height: 1.9em; padding-top: 0.15em; white-space: nowrap; transition: padding-right 0.3s ease;}
		.lorem-ipsum span { margin-right: 0.2em; vertical-align: middle;}
		.age-rating {position: absolute; top: 24.5em; right: 79vw; text-align: left; font-family: "Sofia Sans", sans-serif; font-size: 0.8em; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1); opacity: 1; color: #fff; z-index: 1002; box-sizing: border-box; background: transparent; max-width: fit-content; padding-left: 0.3em; padding-right: 0.3em; display: flex; flex-direction: row; max-height: 1.9em; padding-top: 0.15em; white-space: nowrap;}
		.plot { position: absolute; color: #fff; font-family: "Sofia Sans", sans-serif; background: transparent; padding: 10px; z-index: 7; box-sizing: border-box; padding-bottom: 3px; padding-top: 0.5em; line-height: 1.2em; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1); display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; border-bottom-left-radius: 0.45em; transition: opacity 0.1s ease; text-align: center;}
		.genres { position: absolute; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1); color: #fff; font-family: "Sofia Sans", sans-serif; overflow: hidden; height: 1.95em; padding-top: 0.25em; line-height: 2em; white-space: nowrap;}		
		.premiere-year {position: absolute; top: 5.75em; left: 0.5em; font-size: 0.9em; font-family: "Sofia Sans", sans-serif; color: #fff; z-index: 3; opacity: 0; transition: opacity 0.3s; text-align: center; width: 3.5em;}
		.additional-info {position: absolute; top: 7.3em; left: 31em; font-size: 0.9em; font-family: "Sofia Sans", sans-serif; color: #fff; z-index: 3; opacity: 1; transition: opacity 0.3s; text-align: right; width: 5em;}
		.community-rating {position: absolute; font-family: "Sofia Sans", sans-serif; color: #fff; z-index: 3; opacity: 1; transition: opacity 0.3s; text-align: center; width: 3.6em; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.critic-rating {position: absolute; top: 5.75em; right: 73%; font-size: 0.9em; font-family: "Sofia Sans", sans-serif; color: #fff; z-index: 3; opacity: 1; transition: opacity 0.3s; text-align: center; width: 3.9em; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.slide:hover .backdrop {filter: brightness(95%) contrast(105%) saturate(105%); transform:scale(1);}
		.slide:hover .clickable-overlay { }
		.slide:hover .clickable-overlay::before { opacity: 0; backdrop-filter: blur(0px);}
		.slide:hover .logo { }
		.slide:hover .plot { }
		.slide:hover .lorem-ipsum::before { opacity:1; backdrop-filter: blur(2px); transform: translateX(0); }
		.star-icon { color: gold; font-size: 0.9em;  padding-right: 0.2em; margin-left: -0.1em;}
		@media (max-width: 951px) { .slide {width: 100vw !important; margin: 0; border-radius: 1em; -webkit-mask-image: linear-gradient(180deg, rgb(0% 0% 0%) 0%, rgb(0% 0% 0% / 0.99609375) 6.25%, rgb(0% 0% 0% / 0.984375) 12.5%, rgb(0% 0% 0% / 0.96484375) 18.75%, rgb(0% 0% 0% / 0.9375) 25%, rgb(0% 0% 0% / 0.90234375) 31.25%, rgb(0% 0% 0% / 0.859375) 37.5%, rgb(0% 0% 0% / 0.80859375) 43.75%, rgb(0% 0% 0% / 0.75) 50%, rgb(0% 0% 0% / 0.68359375) 56.25%, rgb(0% 0% 0% / 0.609375) 62.5%, rgb(0% 0% 0% / 0.52734375) 68.75%, rgb(0% 0% 0% / 0.4375) 75%, rgb(0% 0% 0% / 0.33984375) 81.25%, rgb(0% 0% 0% / 0.234375) 87.5%, rgb(0% 0% 0% / 0.12109375) 93.75%, rgb(0% 0% 0% / 0) 100% );} .age-rating {display: none !important;} .genres {display: none !important;} .age-rating {position: absolute; top: 1em; left: 1em; font-size: 0.85em;} .lorem-ipsum {display: inline; font-size: 0.7em; transform: translateX(50%); right: 49vw; padding-left: 0; padding-right: 1em;} .logo { transform: translateX(-50%) translateY(-50%); top: 38%; left: 68% !important; max-width: 58%; max-height: 40%; transform-origin: 50% 50%; display: block; position: fixed; z-index: 15;} .plot {display: none; opacity: 1 !important; font-size: 90%; bottom: 0.5em; -webkit-line-clamp: 2; max-height: 3.3em; overflow: hidden; width: 98vw !important; max-width: 98vw; line-height: 1.45em;} .lorem-ipsum::before { opacity:0; padding-bottom: 0.25em; } .clickable-overlay { background: linear-gradient(0deg, rgb(0% 0% 0%) 0%, rgb(0% 0% 0% / 0.9990234375) 6.25%, rgba(0, 0, 0, 0.99) 12.5%, rgba(0, 0, 0, 0.97) 18.75%, rgba(0, 0, 0, 0.94) 25%, rgba(0, 0, 0, 0.88) 31.25%, rgba(0, 0, 0, 0.79) 37.5%, rgba(0, 0, 0, 0.67) 43.75%, rgba(0, 0, 0, 0.5) 50%, rgba(0, 0, 0, 0.33) 56.25%, rgba(0, 0, 0, 0.21) 62.5%, rgba(0, 0, 0, 0.12) 68.75%, rgba(0, 0, 0, 0.06) 75%, rgba(0, 0, 0, 0.03) 81.25%, rgba(0, 0, 0, 0.01) 87.5%, rgba(0, 0, 0, 0) 93.75%, rgba(0, 0, 0, 0) 100% ); opacity: 0.8;} .backdrop {-webkit-mask-image: linear-gradient(180deg, rgb(0% 0% 0%) 0%, rgb(0% 0% 0% / 0.99609375) 6.25%, rgb(0% 0% 0% / 0.984375) 12.5%, rgb(0% 0% 0% / 0.96484375) 18.75%, rgb(0% 0% 0% / 0.9375) 25%, rgb(0% 0% 0% / 0.90234375) 31.25%, rgb(0% 0% 0% / 0.859375) 37.5%, rgb(0% 0% 0% / 0.80859375) 43.75%, rgb(0% 0% 0% / 0.75) 50%, rgb(0% 0% 0% / 0.68359375) 56.25%, rgb(0% 0% 0% / 0.609375) 62.5%, rgb(0% 0% 0% / 0.52734375) 68.75%, rgb(0% 0% 0% / 0.4375) 75%, rgb(0% 0% 0% / 0.33984375) 81.25%, rgb(0% 0% 0% / 0.234375) 87.5%, rgb(0% 0% 0% / 0.12109375) 93.75%, rgb(0% 0% 0% / 0) 100% ); left: 0% !important; width: 100% !important; top: 0em;} .lorem-ipsum .full-content { opacity: 1; max-width: 100%;} .lorem-ipsum::before { opacity:1; backdrop-filter: blur(2px); transform: translateX(0);} .clickable-overlay::before { opacity: 0.98; backdrop-filter: blur(0px);} .slide:hover .clickable-overlay::before { opacity: 0.98;} .genres {bottom: 4em; left: unset !important; overflow: hidden; max-width: 100vw !important; white-space: nowrap; left: 0; z-index: 8; color: #fff; font-size: 0.7em;} .additional-info {left: 18.5%; top: 5em; text-align: right;} .community-rating {left: 86vw !important; top: 19.45em !important; text-align: left; z-index: 8;   font-size: 0.85em !important;} .critic-rating {font-size: 0.85em !important; left: 70vw !important; top: 19.45em !important; z-index: 8;} .additional-info {left: 18.5%; top: 5em; text-align: left;} .heading {z-index: 0;} .heading::before {display: none;} .video-container {max-width: 0 !important;} .watch-trailer-button {display: flex !important; top: unset !important; font-size: 0.7em !important; background: transparent; color: #ffffffed; !important; font-weight: 600;} .slide { box-shadow: none;} .details-button { border: none; border-radius: 0; padding: 0.5em 1.5em; font-family: "Sofia Sans", sans-serif; cursor: pointer; z-index: 10; transition: background-color 0.3s ease; align-items: center; justify-content: center; font-size: 0.7em !important; color: #ffffffed; !important;; font-weight: 600; display: none; height: 50vh;} .details-button:hover { background-color: #000d;} .watch-trailer-button {  height: fit-content; color: #ffffffed; !important;} .watch-trailer-button:hover { background-color: transparent !important;} .fas {padding: 0.5em;} .text-container { display: none !important; } .buttons-container {display: flex; width: fit-content; position: absolute; top: 69vh; right: 0; left: 10vh; height: fit-content; transform: none; z-index: 20; }}
		@media (max-width:951px) and (orientation:portrait) {.slide {height: 100vh;} .spotlight-poster {display: block; top: 16vh; left: 2vw; height: 25vh; transform: none !important;} .back-button {opacity: 0; top: 5em !important; left: 0.5em;} .logo {top: 29vh;} .lorem-ipsum {right: 48vw;} .skip-button {top: 5em !important; right: 0.5em; opacity: 0;} .genres {right: 50vw; position: absolute; max-width: 80vw !important; overflow:hidden; top: unset; transform: translateX(50%); bottom: 6.5em;} .lorem-ipsum {position: absolute; left: unset; bottom: 4.75em;}  .buttons-container { bottom: unset; left: 4.5vh; top: 41vh; }}
		@media (max-width:951px) and (orientation:landscape) { .buttons-container {bottom: unset; left: 10.5vh; top: 68vh; } .logo {left: 57% !important;} .slide {height: 100vh;} .spotlight-poster {display: block; top: 16vh; left: 2vw; height: 52vh; transform: none !important;} {display: block; top: 16vh; left: 2vw; height: 52vh; transform: none !important;} .community-rating {left:89vw !important;} .critic-rating {left:76vw !important;} .back-button {top: 4em !important; left: 0.5em; opacity: 0;} .skip-button {opacity: 0; top: 4em !important; right: 0.5em;} .genres {position: absolute; bottom: 6.5em; top: unset; transform: translateX(50%); right: 50vw;} .lorem-ipsum {position: absolute; left: calc(7.8em + 43vw); bottom: 32vh; opacity: 1 !important; z-index: 20; transform: translateX(-50%); right: unset;}}
		@media (min-width: 952px) { .lorem-ipsum {left: 50vw; transition: opacity 0.3s ease; transform: translateX(-50%); top: unset; bottom: 3.5em; padding-left: 0; padding-right: 0;} .watch-trailer-button {display: none;} .backdrop {left: 0em; width: 100%;} .genres { transition: opacity 0.3s ease; max-width: 39em; transform: translateX(-50%);} .community-rating {top: 16.45em; left: 31em; font-size: 1em;} .critic-rating { position: absolute; top: 16.45em; left: 26.5em; font-size: 1em;} .back-button {display: inline-flex; justify-content: center; align-items: center; width: 1em; height: 1em; border-radius: 50%; overflow: hidden; transition: background 0.3s, color 0.3s; color: #ffffffa1; left: 0.5em;} .skip-button {display: inline-flex; justify-content: center; align-items: center; width: 1em; height: 1em; border-radius: 50%; overflow: hidden; transition: background 0.3s, color 0.3s; color: #ffffffa1; right: 0.5em;} .text-container::before { content: ''; z-index: 5; display: flex; position: absolute; width: 100vw; bottom: 0; height: 100vh; backdrop-filter: blur(0px); border-top-right-radius: 1em; border-top-left-radius: 1em; -webkit-mask-image: linear-gradient(0deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.25) 3%, rgba(0, 0, 0, 0.5) 7%, rgba(0, 0, 0, 0.75) 15%, rgba(0, 0, 0, 0.9) 25%, rgba(0, 0, 0, 1) 35%, rgba(0, 0, 0, 1) 100%);} .text-container::after { content: ''; background: linear-gradient(0deg, rgb(0% 0% 0%) 0%, rgb(0% 0% 0% / 0.9990234375) 6.25%, rgb(0% 0% 0% / 0.9921875) 12.5%, rgb(0% 0% 0% / 0.9736328125) 18.75%, rgb(0% 0% 0% / 0.9375) 25%, rgb(0% 0% 0% / 0.8779296875) 31.25%, rgb(0% 0% 0% / 0.7890625) 37.5%, rgb(0% 0% 0% / 0.6650390625) 43.75%, rgb(0% 0% 0% / 0.5) 50%, rgb(0% 0% 0% / 0.3349609375) 56.25%, rgb(0% 0% 0% / 0.2109375) 62.5%, rgb(0% 0% 0% / 0.1220703125) 68.75%, rgb(0% 0% 0% / 0.0625) 75%, rgb(0% 0% 0% / 0.0263671875) 81.25%, rgb(0% 0% 0% / 0.0078125) 87.5%, rgb(0% 0% 0% / 0.0009765625) 93.75%, rgb(0% 0% 0% / 0) 100% ); z-index: 5; display: flex; position: absolute; width: 100vw; border-bottom-left-radius: 1em; bottom: 0em; height: 100vh; opacity: 1; backdrop-filter: blur(0px); pointer-events: none;} .skip-button:hover {background: #101010a8; color: #fff;} .back-button:hover {background: #101010a8; color: #fff;}}
		@media (min-width: 1950px) { .slide {font-size: 133.333%;} }
		@media (min-width: 3000px) { .slide {font-size: 200%;} }
		.age-rating { font-weight: 600; font-size: 0.8em;} .additional-info {display: none;}
		.age-rating span[class$="-u"], .age-rating span[class$="-pg"], .age-rating span[class$="u"], .age-rating span[class$="pg"] { background-color: #078c6d; color: white; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.age-rating span[class$="-12a"], .age-rating span[class$="/31 2a"] { background-color: #ee7600; color: white; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.age-rating span[class$="-12"], .age-rating span[class$="-15"] ,.age-rating span[class$="\31 2"], .age-rating span[class$="\31 5"] { background-color: #e19887; color: #e2002d; border: 0.09em solid white !important; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.age-rating span[class$="-y7"], .age-rating span[class$="-13"], .age-rating span[class$="-14"], .age-rating span[class$="-6"], .age-rating span[class$="-ma"], .age-rating span[class$="-y"], .age-rating span[class$="-g"], .age-rating span[class$="tv-pg"] { background-color: #157c0d; color: white; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.age-rating span[class$="-17"], .age-rating span[class$="-18"], .age-rating span[class$="/31 8"], .age-rating span[class$="r"], .age-rating span[class$="-r"] { background-color: #c10f1f; color: white; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.age-rating span[class$="-g"], .age-rating span[class$="g"] { background-color: #078c6d; color: white; text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);}
		.video-container {overflow: visible;}
		.watch-trailer-button { border: none; border-radius: 0px; padding: 0.5em 1em; font-size: 0.9em; font-family: "Sofia Sans", sans-serif; cursor: pointer; z-index: 10; transition: background-color 0.3s ease; align-items: center; justify-content: center; padding-right: 1.5em;}
		.watch-trailer-button .fa-play { margin-right: 0.5em;}
		.slide { position: relative; width: 100%; overflow: hidden; opacity: 1; transition: opacity 0.31s ease-in-out, font-size 1s ease; }
		.fade-in { opacity: 0; visibility: hidden; transition: opacity 0.31s ease-in-out;}
		.fade-in-active { opacity: 1; visibility: visible;}
		.fade-out {	opacity: 0;}
		.backdrop {	transition: opacity 0.3s ease-in-out, width 0.5s ease, transform 1.5s ease, filter 1s ease;}
        #video-overlay { position: fixed; top: 50vh; border-radius: 1em; left: 50vw; width: 50vw; height: 50vh; background-color: rgb(0, 0, 0); z-index: 1000; background-size: cover; padding: 6vh; transform: translateX(-50%) translateY(-50%);}
        #video-overlay-content { position: relative; width: 100%; max-width: 100%; height: 100%; background-color: #000;}
	    @media (orientation: portrait) { #video-overlay { position: fixed; top: 25%; border-radius: 1em; left: 50%; max-width: 100vw; max-height: 50vw; background-color: rgb(0, 0, 0); z-index: 1000; width: 100vw; background-size: cover;}}
        #close-overlay { position: absolute; top: -1em; right: 0em; font-size: 1.5em; color: #7b7b7b; cursor: pointer;} 
		#countdown-bar-container { display: none; position: absolute; left: 0%; top: 3.1em; width: 110%; height: 0.15em !important; background-color: rgba(0,0,0,0); z-index: 10;}
		#countdown-bar { height: 100%; width: 0%; background-color: #ffffff; opacity: 0.5; transition: width 0.1s linear; border-radius: 1em;}
		.video-player { }
		.video-container:hover .video-player { }
		.text-container { display: flex; position: absolute; width: 100vw; bottom: 0em; opacity: 1; z-index: 41; font-size: 1.1em;}
		.material-symbols-outlined { vertical-align: middle; font-size: 0.85em; opacity: 0.75; }
		.spotlight-poster {position: absolute; aspect-ratio: 2 / 3;background-size: cover;background-position: center;border-radius: 0.3em;box-shadow: 0 0.4em 1em rgba(0, 0, 0, 0.6);cursor: pointer; transition: transform 0.3s ease, opacity 1s ease-out, box-shadow 0.25s ease-in-out;z-index: 8;}
		@keyframes posterFadeIn {0% { opacity: 0; } 50% { opacity: 0; } 100% { opacity: 1; }}
		@keyframes posterFadeOut {0% { opacity: 1; } 50% { opacity: 1; } 100% { opacity: 0; }}
		@keyframes logoSlide { 0% { transform: translateY(-65%) translateX(-38%) scale(1.3); } 100% { transform: translateY(-50%) translateX(-38%) scale(1.0); } }
		@keyframes logoFade { from { opacity: 0; } to { opacity: 1; } }
		.spotlight-poster:hover { box-shadow: 0px 0px 5px #fffa;}
		.spotlight-poster.active { transform: translateX(-50%); opacity: 1;}
		@keyframes fadeIn { to { opacity: 1;} }
		.plot { opacity: 0; }
		@keyframes fadeIn { to { opacity: 1;} }	
		.genres { opacity: 0; }
		@keyframes fadeIn { to { opacity: 1;} }	
		.lorem-ipsum { opacity: 0; }
		@keyframes fadeIn { to { opacity: 1;} }
		.text-container::after { opacity: 0.7; }
	    .buttons-container { opacity: 1; }
		.age-rating { opacity: 0; animation: fadeInOut 5s forwards;}
		@keyframes fadeInOut { 0% { opacity: 0;} 20% { opacity: 0; } 60% { opacity: 1; } 90% { opacity: 1; } 100% { opacity: 0; }}
		@media (min-width: 952px) {
		.age-rating { display: none;}
		.backdrop { border-radius: 0; pointer-events: none; -webkit-mask-image: linear-gradient(180deg, rgb(0% 0% 0%) 0%, rgb(0% 0% 0% / 0.99609375) 6.25%, rgb(0% 0% 0% / 0.984375) 12.5%, rgb(0% 0% 0% / 0.96484375) 18.75%, rgb(0% 0% 0% / 0.9375) 25%, rgb(0% 0% 0% / 0.90234375) 31.25%, rgb(0% 0% 0% / 0.859375) 37.5%, rgb(0% 0% 0% / 0.80859375) 43.75%, rgb(0% 0% 0% / 0.75) 50%, rgb(0% 0% 0% / 0.68359375) 56.25%, rgb(0% 0% 0% / 0.609375) 62.5%, rgb(0% 0% 0% / 0.52734375) 68.75%, rgb(0% 0% 0% / 0.4375) 75%, rgb(0% 0% 0% / 0.33984375) 81.25%, rgb(0% 0% 0% / 0.234375) 87.5%, rgb(0% 0% 0% / 0.12109375) 93.75%, rgb(0% 0% 0% / 0) 100% ); }
		.back-button, .skip-button { top: 41vh; }
		.buttons-container { }
		.clickable-overlay {display: none;}
		.genres { top: unset !important; bottom: 52.25vh; left: calc(13.2vw + 34vh); font-size: 1.35vh; animation: fadeIn 1s ease-in forwards; animation-delay: 1.2s; font-weight: 400; z-index: 10; transform: translateX(-42%); text-align: center; min-width: 40.8vh;}
		.logo { width: auto; z-index: 15; text-shadow: -2px 2px 4px rgba(0,0,0,0.5); filter: drop-shadow(1px 1px 1px); pointer-events: none; position: absolute; top: 29.5vh; left: calc(13.2vw + 33vh); max-height: calc(1em + 18.7vh) !important; max-width: calc(1em + 36vh) !important; opacity: 0; animation: logoSlide 2s cubic-bezier(0.25,0.46,0.45,0.94) forwards, logoFade 1.5s 0.5s ease-out forwards; transition: opacity 0.3s ease, transform 0.1s ease; }
		.lorem-ipsum { bottom: 55.8vh !important; left: calc(13.2vw + 34vh); font-size: 1.35vh !important; animation: fadeIn 1s ease-in forwards; animation-delay: 1s; font-weight: 400; min-width: 40.8vh !important; transform: translateX(-40%); justify-content: center;}
		.plot {mmax-height: 10vh !important; -webkit-line-clamp: 6 !important; font-size: 1.35vh !important; max-width: 40.8vh !important; width: auto !important; animation: fadeIn 1s ease-in forwards; animation-delay: 1.4s; font-weight: 400; left: calc(13.2vw + 34vh); transform: translateX(-42%); top: -26.5vh}
		.slide {border-radius: 0; height: 100vh !important;}
		.spotlight-poster { top: 7vh; !important; width: 34vh !important; left: 13.2vw; animation: posterFadeIn 1.5s forwards ease-out; z-index: 30;}
		.text-container::before {animation: fadeIn 2s ease-in forwards; opacity: 0; background: linear-gradient(0deg, rgb(6.667% 5.49% 11.765% / 0.86) 0%, rgb(6.667% 5.49% 11.765% / 0.8556766880907268) 6.25%, rgb(6.667% 5.49% 11.765% / 0.8428728948150395) 12.5%, rgb(6.667% 5.49% 11.765% / 0.8220806627680727) 18.75%, rgb(6.667% 5.49% 11.765% / 0.7940990257669732) 25%, rgb(6.667% 5.49% 11.765% / 0.7600033024294105) 31.25%, rgb(6.667% 5.49% 11.765% / 0.7211037722821452) 37.5%, rgb(6.667% 5.49% 11.765% / 0.6788953224536288) 43.75%, rgb(6.667% 5.49% 11.765% / 0.635) 50%, rgb(6.667% 5.49% 11.765% / 0.5911046775463711) 56.25%, rgb(6.667% 5.49% 11.765% / 0.5488962277178548) 62.5%, rgb(6.667% 5.49% 11.765% / 0.5099966975705895) 68.75%, rgb(6.667% 5.49% 11.765% / 0.4759009742330268) 75%, rgb(6.667% 5.49% 11.765% / 0.4479193372319273) 81.25%, rgb(6.667% 5.49% 11.765% / 0.42712710518496044) 87.5%, rgb(6.667% 5.49% 11.765% / 0.41432331190927313) 93.75%, rgb(6.667% 5.49% 11.765% / 0.41) 100% ); z-index: 6;}
		.text-container { height: 26vh; animation: fadeIn 1.5s ease-in-out; animation-delay: 0.5s; pointer-events: none; z-index: 9; }
		.text-container::after { -webkit-mask-image: linear-gradient(180deg, rgb(0% 0% 0%) 0%, rgb(0% 0% 0% / 0.99609375) 6.25%, rgb(0% 0% 0% / 0.984375) 12.5%, rgb(0% 0% 0% / 0.96484375) 18.75%, rgb(0% 0% 0% / 0.9375) 25%, rgb(0% 0% 0% / 0.90234375) 31.25%, rgb(0% 0% 0% / 0.859375) 37.5%, rgb(0% 0% 0% / 0.80859375) 43.75%, rgb(0% 0% 0% / 0.75) 50%, rgb(0% 0% 0% / 0.68359375) 56.25%, rgb(0% 0% 0% / 0.609375) 62.5%, rgb(0% 0% 0% / 0.52734375) 68.75%, rgb(0% 0% 0% / 0.4375) 75%, rgb(0% 0% 0% / 0.33984375) 81.25%, rgb(0% 0% 0% / 0.234375) 87.5%, rgb(0% 0% 0% / 0.12109375) 93.75%, rgb(0% 0% 0% / 0) 100% ); opacity: 1; }
		.video-container { display: block; height: 55vh; width: 55vw; z-index: 50; top: 7vh; bottom: unset; right: unset; left: calc(13.2vw + 17vh); opacity: 0; max-width: unset; pointer-events: none;}
		.video-container.on-top { opacity: 1 !important; pointer-events: all; transition: opacity 1s ease-in-out;}
		@keyframes trailerRaise {from { opacity: 0; transform: scale(0.97); } to { opacity: 1; transform: scale(1); }}
		.watch-trailer-button { padding: 0.25em 1.5em; border-radius: 0.8em; background: #110e1ebd; color: white; font-size: 1em; display: flex; align-items: center; gap: 0.5em; cursor: pointer; backdrop-filter: blur(4px); border: 1px solid white; transition: 0.25s ease; z-index: 50; position: absolute; left: calc(8vw + 15vh); bottom: 38vh; animation: fadeIn 1s ease-in forwards; animation-delay: 2s; opacity: 0;}
		.watch-trailer-button:hover { background: white; color: black;}
		@media (min-width: 952px) { .text-container::after { height: 100vh; } }
    </style>
</head>
<body>
  <div id="slides-container"></div>

  <!-- Overlay used for mobile / fallback playback -->
  <div id="video-overlay" style="display: none;">
    <div id="video-overlay-content">
      <span id="close-overlay" class="fas fa-times"></span>
      <iframe id="trailer-video" width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
    </div>
  </div>

  <script>
	let title = 'Spotlight',
	    moviesSeriesBoth = 3,
	    shuffleInterval = 15000,
	    plotMaxLength = 550,
	    useTrailers = true,
	    isMuted = true;
	let trailerMaxLength = 0;
	let isChangingSlide = false,
	    player = null,
	    slideChangeTimeout = null,
	    isHomePageActive = false,
	    showOnOtherPages = false;
	let currentLocation = window.top.location.href;
	let movieList = [], currentMovieIndex = 0;
	let previousMovies = [], forwardMovies = [];
	let useSponsorBlock = true;
	let monitorOutroInterval = null;
	let currentTrailerVideoId = null;

	const createElem = (tag, className, textContent, src, alt) => {
	  const elem = document.createElement(tag);
	  if (className) elem.className = className;
	  if (textContent) elem.textContent = textContent;
	  if (src) elem.src = src;
	  if (alt) elem.alt = alt;
	  return elem;
	};

	const truncateText = (text, maxLength) =>
	  text && text.length > maxLength ? text.substr(0, maxLength) + '...' : (text || '');

	const cleanup = () => {
	  if (player && typeof player.destroy === 'function') {
	    try { player.destroy(); } catch (e) { }
	  }
	  player = null;
	  currentTrailerVideoId = null;
	  clearTimeout(slideChangeTimeout);
	  slideChangeTimeout = null;
	  const container = document.getElementById('slides-container');
	  if (container) container.innerHTML = '';
	  if (monitorOutroInterval) {
	    clearInterval(monitorOutroInterval);
	    monitorOutroInterval = null;
	  }
	};

	const fetchSponsorBlockOutro = async (videoId) => {
	  try {
	    const response = await fetch(`https://sponsor.ajay.app/api/skipSegments?videoID=${videoId}&category=outro`);
	    const segments = await response.json();
	    if (segments.length > 0 && Array.isArray(segments[0].segment)) {
	      return segments[0].segment;
	    }
	    return null;
	  } catch (error) {
	    console.error('Error fetching SponsorBlock data:', error);
	    return null;
	  }
	};

	function monitorOutro(playerInstance, outroSegment) {
	  if (monitorOutroInterval) clearInterval(monitorOutroInterval);
	  monitorOutroInterval = setInterval(() => {
	    if (!outroSegment || !playerInstance || typeof playerInstance.getCurrentTime !== 'function') {
	      clearInterval(monitorOutroInterval);
	      monitorOutroInterval = null;
	      return;
	    }
	    const currentTime = playerInstance.getCurrentTime();
	    if (currentTime >= outroSegment[0] && currentTime < outroSegment[1]) {
	      clearInterval(monitorOutroInterval);
	      monitorOutroInterval = null;
	      try { playerInstance.stopVideo(); } catch (e) { }

	      setTimeout(fetchRandomMovie, 100);
	    }
	  }, 500);
	}

	function isMobile() {
	  return window.innerWidth <= 951;
	}

	function clearSlideChangeTimeout() {
	  if (slideChangeTimeout) {
	    clearTimeout(slideChangeTimeout);
	    slideChangeTimeout = null;
	  }
	}

	const startSlideChangeTimer = () => {
	  clearSlideChangeTimeout();
	  slideChangeTimeout = setTimeout(fetchRandomMovie, shuffleInterval);
	};

	const navigateBack = () => {
	  if (previousMovies.length < 2) {
	    console.log("No previous slides in history.");
	    return;
	  }
	  const currentMovie = previousMovies.pop();
	  forwardMovies.unshift(currentMovie);
	  const previousMovie = previousMovies[previousMovies.length - 1];
	  createSlideElement(previousMovie, true);
	};

	const navigateForward = () => {
	  if (forwardMovies.length === 0) {
	    console.log("No forward slides in history. Fetching a new random movie.");
	    fetchRandomMovie();
	    return;
	  }
	  const currentMovie = forwardMovies.shift();
	  previousMovies.push(currentMovie);
	  createSlideElement(currentMovie, true);
	};

	function showVideoOverlay(trailerUrl) {
	  const videoOverlay = document.getElementById('video-overlay');
	  const videoFrame = document.getElementById('trailer-video');
	  const closeOverlay = document.getElementById('close-overlay');
	  const videoId = new URL(trailerUrl).searchParams.get('v');
	  const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1${isMuted ? '&mute=1' : ''}`;
	  videoFrame.src = embedUrl;
	  videoOverlay.style.display = 'block';
	  clearSlideChangeTimeout();

	  closeOverlay.onclick = () => {
	    videoOverlay.style.display = 'none';
	    videoFrame.src = '';
	    startSlideChangeTimer();
	  };

	  window.onclick = (event) => {
	    if (event.target === videoOverlay) {
	      videoOverlay.style.display = 'none';
	      videoFrame.src = '';
	      startSlideChangeTimer();
	    }
	  };
	}

	function closeVideoOverlay() {
	    const videoOverlay = document.getElementById('video-overlay');
	    const videoFrame = document.getElementById('trailer-video');
	    if (!videoOverlay) return;

	    videoOverlay.classList.remove('visible');
	    setTimeout(() => {
	        videoOverlay.style.display = 'none';
	        videoFrame.src = '';
	        startSlideChangeTimer();
	    }, 500);
	}

	const createSlideElement = (movie, hasVideo = false) => {
	cleanup();

	const container = document.getElementById('slides-container');
	const slide = createElem('div', 'slide');

	if (movie && (!previousMovies.length || previousMovies[previousMovies.length - 1].Id !== movie.Id)) {
	previousMovies.push(movie);
	}
	if (previousMovies.length > 50) previousMovies.shift();

	['backdrop', 'logo'].forEach(type => {
	const img = createElem('img', type, null, `/Items/${movie.Id}/Images/${type.charAt(0).toUpperCase() + type.slice(1)}${type === 'backdrop' ? '/0' : ''}`);
	slide.appendChild(img);
	});

	slide.appendChild(createElem('div', 'heading', title));

	const textContainer = createElem('div', 'text-container');
	const premiereYear = movie.PremiereDate ? new Date(movie.PremiereDate).getFullYear() : '';
	let additionalInfo = '';

	if (movie.Type === 'Series') {
	additionalInfo = movie.ChildCount ? `${movie.ChildCount} Season${movie.ChildCount > 1 ? 's' : ''}` : '';
	} else if (movie.Type === 'BoxSet') {
	additionalInfo = movie.ChildCount ? `${movie.ChildCount} Movie${movie.ChildCount > 1 ? 's' : ''}` : '';
	} else {
	const runtimeMinutes = movie.RunTimeTicks ? Math.floor(movie.RunTimeTicks / 600000000) : 0;
	additionalInfo = runtimeMinutes > 0 ? `${runtimeMinutes} min` : '';
	}

	let infoHtml = '';
	if (additionalInfo) infoHtml += `<span style="background: transparent; padding-left: 0em; padding-right: 0em; padding-top: 0.05em; padding-bottom: 0.05em; margin-left: 0em;">${additionalInfo}</span>`;
	if (premiereYear) infoHtml += `<span style="background: transparent; padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.05em; padding-bottom: 0.05em; margin-left: 1em;">${premiereYear}</span>`;
	if (movie.CommunityRating) infoHtml += `<span style="background: transparent; padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.05em; padding-bottom: 0.05em; margin-left: 1em;"><i class="star-icon fas fa-star"></i> ${movie.CommunityRating.toFixed(1)}</span>`;
	if (movie.CriticRating) infoHtml += `<span style="background: transparent; padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.1em; padding-bottom: 0.05em; margin-left: 1em;"><img src="/web/assets/img/fresh.svg" alt="Rotten Tomatoes" style="width: 1.05em; font-size: 0.83em; padding-right: 0.4em; margin-left: -0.1em; vertical-align: middle; padding-bottom: 0.4em;"> ${movie.CriticRating}%</span>`;

	const loremDiv = createElem('div', 'lorem-ipsum');
	loremDiv.innerHTML = infoHtml;
	textContainer.appendChild(loremDiv);

	textContainer.appendChild(createElem('div', 'plot', truncateText(movie.Overview, plotMaxLength)));
	slide.appendChild(textContainer);

	const posterUrl = `/Items/${movie.Id}/Images/Primary?fillHeight=720&fillWidth=480&quality=96`;
	const posterDiv = document.createElement('div');
	posterDiv.className = 'spotlight-poster';
	posterDiv.style.backgroundImage = `url('${posterUrl}')`;
	posterDiv.setAttribute('role', 'img');
	posterDiv.setAttribute('aria-label', `${movie.Name} poster`);
	posterDiv.onclick = () => window.top.location.href = `/#!/details?id=${movie.Id}`;
	slide.appendChild(posterDiv);
	setTimeout(() => posterDiv.classList.add('active'), 300);

	const backButton = createElem('div', 'back-button');
	const backIcon = createElem('i', 'material-icons');
	backIcon.textContent = 'chevron_left';
	backButton.appendChild(backIcon);
	backButton.onclick = (e) => { e.stopPropagation(); navigateBack(); };
	const skipButton = createElem('div', 'skip-button');
	const skipIcon = createElem('i', 'material-icons');
	skipIcon.textContent = 'chevron_right';
	skipButton.appendChild(skipIcon);
	skipButton.onclick = (e) => { e.stopPropagation(); navigateForward(); };
	slide.appendChild(backButton);
	slide.appendChild(skipButton);

	const buttonsContainer = createElem('div', 'buttons-container');

	const detailsButton = createElem('button', 'details-button');
	const playIcon = createElem('i', 'fas fa-play');
	detailsButton.appendChild(playIcon);
	detailsButton.appendChild(document.createTextNode(' Play'));
	detailsButton.onclick = (e) => { e.stopPropagation(); window.top.location.href = `/#!/details?id=${movie.Id}`; };
	buttonsContainer.appendChild(detailsButton);

	const hasTrailer =
	movie.RemoteTrailers &&
	Array.isArray(movie.RemoteTrailers) &&
	movie.RemoteTrailers.length > 0 &&
	movie.RemoteTrailers[0].Url;

	if (hasTrailer) {
	const trailerUrl = movie.RemoteTrailers[0].Url;
	const watchTrailerButton = createElem('button', 'watch-trailer-button');
	const trailerIcon = document.createElement('i');
	trailerIcon.className = 'fas fa-film';
	watchTrailerButton.appendChild(trailerIcon);
	watchTrailerButton.appendChild(document.createTextNode(' Trailer'));

	watchTrailerButton.onclick = (e) => {
	    e.stopPropagation();

	    const vc = slide.querySelector('.video-container');
	    const videoOverlay = document.getElementById('video-overlay');
	    const videoFrame = document.getElementById('trailer-video');

	    if (isMobile()) {
	        showVideoOverlay(trailerUrl);
	        return;
	    }

	    if (vc) {
	        const isOpen = vc.classList.contains('on-top');
	        if (isOpen) {
	            vc.classList.remove('on-top');
	            if (player && typeof player.pauseVideo === 'function') try { player.pauseVideo(); } catch (_) {}
	            startSlideChangeTimer();
	        } else {
	            vc.classList.add('on-top');
	            clearSlideChangeTimeout();
	            if (player && typeof player.playVideo === 'function') {
	                try {
	                    if (isMuted) try { player.mute(); } catch (_) {}
	                    else try { player.unMute(); player.setVolume(100); } catch (_) {}
	                    player.playVideo();
	                } catch (err) {
	                    console.error('Error attempting to play trailer inline:', err);
	                    const btn = slide.querySelector('.watch-trailer-button');
	                    if (btn) btn.style.display = 'none';
	                }
	            }
	        }
	    }

	    if (videoOverlay) {
	        videoFrame.src = `https://www.youtube.com/embed/${new URL(trailerUrl).searchParams.get('v')}?autoplay=1${isMuted ? '&mute=1' : ''}`;
	        videoOverlay.classList.add('visible');

	        videoOverlay.onclick = (event) => {
	            if (event.target === videoOverlay) closeVideoOverlay();
	        };
	    }
	};


	buttonsContainer.appendChild(watchTrailerButton);
	}

	slide.appendChild(buttonsContainer);

	const overlay = createElem('div', 'clickable-overlay');
	overlay.onclick = () => window.top.location.href = `/#!/details?id=${movie.Id}`;
	slide.appendChild(overlay);

	if (useTrailers && hasTrailer) {
	const trailerUrl = movie.RemoteTrailers[0].Url;
	const videoId = new URL(trailerUrl).searchParams.get('v');
	currentTrailerVideoId = videoId;

	const videoContainer = createElem('div', 'video-container');
	const videoElement = createElem('div', 'video-player');
	videoContainer.appendChild(videoElement);
	slide.appendChild(videoContainer);

	player = new YT.Player(videoElement, {
	height: '100%',
	width: '100%',
	videoId,
	playerVars: {
	  autoplay: 0,
	  controls: 1,
	  disablekb: 1,
	  fs: 1,
	  iv_load_policy: 3,
	  rel: 0,
	  modestbranding: 1,
	  mute: isMuted ? 1 : 0
	},
	events: {
	  'onReady': event => {
	    try {
	      if (isMuted) {
	        event.target.mute();
	      } else {
	        event.target.unMute();
	        if (typeof event.target.setVolume === 'function') {
	          event.target.setVolume(100);
	        }
	      }
	    } catch (_) {}
	  },
	  'onStateChange': (event) => {
	    if (event.data === YT.PlayerState.ENDED) {
	      setTimeout(fetchRandomMovie, 100);

	    } else if (event.data === YT.PlayerState.PLAYING) {
	      clearSlideChangeTimeout();

	      if (useSponsorBlock && currentTrailerVideoId) {
	        fetchSponsorBlockOutro(currentTrailerVideoId)
	          .then(outroSegment => {
	            if (outroSegment) {
	              console.log(
	                `SponsorBlock outro segment: Start - ${outroSegment[0]}s, End - ${outroSegment[1]}s`
	              );
	              monitorOutro(player, outroSegment);
	            }
	          })
	          .catch(err =>
	            console.error('Error reading SponsorBlock outro segment:', err)
	          );
	      }

	      if (trailerMaxLength > 0) {
	        clearTimeout(slideChangeTimeout);
	        slideChangeTimeout = setTimeout(() => {
	          try { player.stopVideo(); } catch (_) {}
	          try { player.destroy(); } catch (_) {}
	          player = null;
	          setTimeout(fetchRandomMovie, 100);
	        }, trailerMaxLength);
	      }

	    } else if (event.data === YT.PlayerState.PAUSED) {
	      clearSlideChangeTimeout();
	      slideChangeTimeout = setTimeout(fetchRandomMovie, shuffleInterval);

	    } else if (event.data === YT.PlayerState.BUFFERING) {
	    }
	  },
	'onError': () => {
	  console.error(`YouTube prevented playback of '${movie.Name}' or an error occurred.`);
	  
	  if (player) {
	    try { player.destroy(); } catch (_) {}
	    player = null;
	  }

	  const trailerButton = slide.querySelector('.watch-trailer-button');
	  if (trailerButton) trailerButton.style.display = 'none';

	  startSlideChangeTimer();
	}
	}
	});

	} else {
	startSlideChangeTimer();
	}

	addSwipeListeners(slide);

	container.innerHTML = '';
	container.appendChild(slide);
	};

    function addSwipeListeners(slide) {
      let startX, startY, distX = 0, distY = 0;
      const threshold = 50;
      const restraint = 100;

      slide.addEventListener('touchstart', (e) => {
        const touch = e.touches[0];
        startX = touch.clientX;
        startY = touch.clientY;
        distX = 0; distY = 0;
      }, { passive: true });

      slide.addEventListener('touchmove', (e) => {
        const touch = e.touches[0];
        distX = touch.clientX - startX;
        distY = touch.clientY - startY;
        if (Math.abs(distX) > Math.abs(distY)) e.preventDefault();
      }, { passive: false });

      slide.addEventListener('touchend', () => {
        if (Math.abs(distX) > threshold && Math.abs(distY) < restraint) {
          if (distX > 0) navigateBack();
          else navigateForward();
        }
        distX = distY = 0;
      }, { passive: true });
    }

    const readCustomList = async () => {
      try {
        const res = await fetch('List.txt?' + Date.now());
        if (!res.ok) return null;
        const text = await res.text();
        if (!text || !text.trim()) return null;
        const lines = text.split('\n').map(l => l.trim()).filter(Boolean);
        // Expect first line like: Spotlight MuteOn  OR Spotlight MuteOff
        const first = lines.shift().trim().split(/\s+/);
        const parsedTitle = first[0] || title;
        const muteSetting = first[1] || (isMuted ? 'MuteOn' : 'MuteOff');
        title = parsedTitle || title;
        isMuted = (muteSetting === 'MuteOn');

        const results = await Promise.all(lines.map(async line => {
          const mediaId = line.trim().substring(0, 32);
          if (await checkIfCollection(mediaId)) {
            const items = await fetchCollectionItems(mediaId);
            return items || [];
          } else {
            return [mediaId];
          }
        }));
        const mediaList = results.flat();
        return shuffleArray(mediaList);
      } catch (e) {
        console.error('Error reading List.txt.', e);
        return null;
      }
    };

    const checkIfCollection = async (itemId) => {
      try {
        const creds = JSON.parse(localStorage.getItem('jellyfin_credentials'));
        const token = creds?.Servers?.[0]?.AccessToken;
        const headers = { 'Authorization': `MediaBrowser Client="Jellyfin Web", Token="${token}"` };
        const response = await fetch(`/Items/${itemId}?Fields=Type`, { headers });
        const data = await response.json();
        return data.Type === "BoxSet";
      } catch (error) {
        console.error(`Error checking item type for ID: ${itemId}`, error);
        return false;
      }
    };

    const fetchCollectionItems = async (collectionId) => {
      try {
        const creds = JSON.parse(localStorage.getItem('jellyfin_credentials'));
        const token = creds?.Servers?.[0]?.AccessToken;
        const headers = { 'Authorization': `MediaBrowser Client="Jellyfin Web", Token="${token}"` };
        const response = await fetch(`/Items?ParentId=${collectionId}&Recursive=true&Fields=Id`, { headers });
        const data = await response.json();
        return data.Items ? data.Items.map(item => item.Id) : [];
      } catch (error) {
        console.error(`Error fetching collection items for ID: ${collectionId}`, error);
        return [];
      }
    };

    const fetchRandomMovie = () => {
      if (isChangingSlide) return;
      isChangingSlide = true;
      if (movieList.length === 0) {
        readCustomList().then(list => {
          if (list && list.length > 0) {
            movieList = list;
            currentMovieIndex = 0;
            fetchNextMovie();
          } else {
            console.warn("Fallback to random selection.");
            fetchNextMovie(true);
          }
        });
      } else {
        fetchNextMovie();
      }
    };

    const shuffleArray = (array) => {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    };

    const fetchNextMovie = (useRandom = false) => {
      isChangingSlide = false;
      try {
        const creds = JSON.parse(localStorage.getItem('jellyfin_credentials'));
        const token = creds?.Servers?.[0]?.AccessToken;
        const headers = { 'Authorization': `MediaBrowser Client="Jellyfin Web", Token="${token}"` };

        if (!useRandom && movieList.length > 0) {
          if (currentMovieIndex >= movieList.length) currentMovieIndex = 0;
          const movieId = movieList[currentMovieIndex];
          currentMovieIndex++;
          fetch(`/Items/${movieId}?Fields=Overview,RemoteTrailers,PremiereDate,RunTimeTicks,ChildCount,Genres,CommunityRating,CriticRating,OfficialRating`, { headers })
            .then(response => response.json())
            .then(checkBackdropAndLogo)
            .catch(() => startSlideChangeTimer());
        } else {
          const itemTypes = moviesSeriesBoth === 1 ? 'Movie' : (moviesSeriesBoth === 2 ? 'Series' : 'Movie,Series');
          fetch(`/Items?IncludeItemTypes=${itemTypes}&Recursive=true&Limit=1&SortBy=random&Fields=Id,Overview,RemoteTrailers,PremiereDate,RunTimeTicks,ChildCount,Genres,CommunityRating,CriticRating,OfficialRating`, { headers })
            .then(response => response.json())
            .then(data => {
              if (data.Items && data.Items[0]) checkBackdropAndLogo(data.Items[0]);
              else startSlideChangeTimer();
            })
            .catch(() => startSlideChangeTimer());
        }
      } catch (err) {
        console.error('Error fetching next movie', err);
        startSlideChangeTimer();
      }
    };

    const checkBackdropAndLogo = movie => {
      Promise.all([
        fetch(`/Items/${movie.Id}/Images/Backdrop/0`, { method: 'HEAD' }).then(response => response.ok).catch(() => false),
        fetch(`/Items/${movie.Id}/Images/Logo`, { method: 'HEAD' }).then(response => response.ok).catch(() => false)
      ]).then(([backdropExists, logoExists]) => {
        if (backdropExists && logoExists) {
          createSlideElement(movie, true);
        } else {
          fetchRandomMovie();
        }
      }).catch(() => fetchRandomMovie());
    };

    const checkNavigation = () => {
      const newLocation = window.top.location.href;
      if (newLocation !== currentLocation) {
        currentLocation = newLocation;
        const isHomePage = url => url.includes('/home') || url.endsWith('/web/') || url.endsWith('/web/index.html');
        if (!isHomePage(newLocation) && isHomePageActive) {
          console.log("Leaving homepage, cleaning up slideshow and stopping video");
          isHomePageActive = false;
          stopBackgroundVideo();
          cleanup();
        }
        if (isHomePage(newLocation) && !isHomePageActive) {
          console.log("Returning to homepage, reactivating slideshow");
          isHomePageActive = true;
          fetchRandomMovie();
        }
      }
    };

    const stopBackgroundVideo = () => {
      if (player && typeof player.stopVideo === 'function') {
        try { player.stopVideo(); } catch (_) {}
        try { player.destroy(); } catch (_) {}
      }
      if (monitorOutroInterval) { clearInterval(monitorOutroInterval); monitorOutroInterval = null; }
      player = null;
    };

    window.addEventListener('message', (event) => {
      if (!event.data || !event.data.spotlightMode) return;
      if (event.data.spotlightMode === "expanded") document.body.classList.add("expanded-mode");
      else document.body.classList.remove("expanded-mode");
    });

    document.addEventListener('DOMContentLoaded', () => {
      if (window.innerWidth < 951) useTrailers = false;
      const isHomePage = url => url.includes('/home') || url.endsWith('/web/') || url.endsWith('/web/index.html');
      if (isHomePage(window.top.location.href)) {
        isHomePageActive = true;
        // Read list and start
        readCustomList().then(list => {
          if (list) {
            movieList = list;
            currentMovieIndex = 0;
          }
          fetchRandomMovie();
        }).catch(() => fetchRandomMovie());
      }
      const closeOverlay = document.getElementById("close-overlay");
      if (closeOverlay) {
        closeOverlay.addEventListener("click", () => {
          closeVideoOverlay();
        });
      }
    });

    window.addEventListener('unload', cleanup);
    window.addEventListener('popstate', checkNavigation);
    setInterval(checkNavigation, 100);

  </script>

  <script src="https://www.youtube.com/iframe_api"></script>
</body>
</html>
